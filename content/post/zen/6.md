---
title: Goap
date: 2023-12-10
tags: [""]
categories:
description: 
toc: true
draft: true
---



# 

    如何让AI收集世界数据，
    AI本身可以简化为一堆if语句


# FSM
    提供一系列有限状态，每一次过渡需要一些Condition

    但随着状态的越来越多，转换条件也将变的复杂，它本身的拓扑结构是网状的

    通常而言 FSM 不擅长对外界数据变换做出快速反应，通常会长时间陷入某种状态，只适合做一些简单的状态转变，如 Zen 中的 “流程” ，它本身足够简单（状态少，转换条件明确）


# BehaviourTree

    从人为设计的角度讲，更容易设计，但问题是需要遍历整个树 它和FSM都是基于规则的，需要事先定制或考虑到所有规则。此AI的行为更容易预测，会显得死板，而且更难做出新的行为


# BDI

    好了终于进入了正题，在Goap实现之前，最开始是一种基于组合形式的AI系统，为了解决一个新的状态加入而需要做更多的更改

    Goap与上述AI实现最大的区别是我们不再指定一系列规则，而是一系列目标

    BDI   
    + 信念（Beliefs）表示AI所掌握的关于世界的信息，（之所叫信念，我们认为AI所掌握的信息是不正确或者不完整的，它们只是AI所相信的事实）
    
    + 愿望（Desires）表示AI所希望达到的状态，如保证存活，找到目标，杀死目标等
    
    + 意图 (intentions) 表示AI会想办法实现这些愿望，AI会使用意图选择它需要执行的操作
  
  举个栗子
    当AI血线较低的时候，它会为了保证存活，将不会继续攻击玩家（状态），而是去寻找（状态）能恢复生命值的道具或技能（如吸血或者使用道具）

    这一切让AI看起像自己在作选择，而非机械式执行预设行为

    总之，根据一系列意图而不是预设规则做出决策，我们的AI可以显得更加智能，也会尝试满足多种愿望


# GOAP (Goal Oriented Action Planning)


状态：  前置条件 + 状态 + 行动结果
+ Action:
    + Search
        + prev: 未找到玩家
        + stat: 执行搜索
        + effect: 找到玩家
    + Attack
        + prev: 看见玩家
        + stat：攻击玩家
        + effect: 玩家死亡
    + Run
        + prev: 已经找到了玩家
        + state: 执行逃跑操作
        + effect：看不见玩家
    + Heal
        + prev: 看不见玩家且生命值低于20
        + state: 执行治疗操作
        + effect: 生命值100
+ Goal
    + kill player


行动链


为了达到目的，AI将从目的开始倒推制定计划，为了能达到Attack, AI需要开始执行Search行为,

为了确定我们选择何种行动链， 我们还需要给每个行为增加一个cost指标（即权重）如开枪成本高于手雷则它的成本会更高（成本这个概念性问题取决于游戏题材或者实际项目需求，不一概而论）

但总之，行动规划器（Planning）会选择成本最低的行动链

Goap可以让AI执行一连串的的操作，而不需要明确告诉它怎么做，如攻击之前需要拾取武器，我们在行动池里面添加一个满足这个条件的行为即可


在AI执行的时候，世界的条件可能会发生改变，最终影响一个或多个行动的前置条件，导致计划失败，此时，Ai必须重新规划，并根据世界的（状态）改变定制新的计划

Goap非常优雅，只需要添加行动并正确设置前置条件的行动结果，就能轻松创建新的行为，其余部分交由行动规划器自动处理。我们所需要做的事情就是给AI设定正确的目标

<!--adsense-->