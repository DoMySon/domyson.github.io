---
title: 服务器如何保证缓存一致性
date: 2022-04-14
categories: ['mysql']
description: 
toc: true
draft: true
---


# [数据一致性问题](https://cloud.tencent.com/developer/article/1917325)

+ 读数据：当请求某个数据时，首先查缓存，若没有找到则去 mysql 中读取，然后更新缓存。

+ 写数据：如果更新缓存的时候只要有一方失败，则数据不一致问题变产生了，现实情况下无论如何都保证不了强一致性，只能降低概率来解决

<!--more-->


# 目前大致四种方案

## 先删除缓存，再更新数据库

### 单线程

+ 若缓存删除成功，但更新数据库失败的情况，从而导致数据库读到旧值

### 多线程

+

## 先更新数据库，再删除缓存

### 单线程

+ 若删除缓存成功，更新数据库失败，则下一次会读到数据库旧值

+ 若更新数据库成功，删除缓存失败，则下一次会读到缓存旧值

1. 解决策略 消息队列+异步重试，

## 只更新缓存，不更新数据库(mysql异步更新)


## 更新缓存，也更新数据库


