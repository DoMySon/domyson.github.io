<!doctype html>
<html lang="en">
  <head>
    <title>sknt设计初衷以及特性 // Treasure</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.119.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Treasure" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.3c3c186cd62e563ad6e2f00a89dbee656ab912d1d46f856b5605dd0232521e2a.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="sknt设计初衷以及特性"/>
<meta name="twitter:description" content="简介 sknt 是一个基于消息和服务的分布式服务框架，采用go编写，致力于简化开发难度和成本， 它是一个年轻的框架，仅仅经历了两款项目
羽翼军团 我在民国淘古玩 设计概述 工作中开发一个分布式多人在线游戏的时候构建了一个cobweb的分布式通讯框架（基于golang,c）。
但是在实际开发过程中代码难以维护以及更新，主要是每次都需要跨平台进行编译，特别是cgo 往往需要指定平台的系统库。
而且一些不规范的使用方式造成无法充分发挥多核的优势，可以参见 关于Go协程的思考 虽然1.16 支持抢占式，但错误的使用方式依然造成了cpu过高的问题。
再者，服务器过多的 goroutine 被创建，极大浪费了内存以及cpu。
基于以上目的，重写了cobweb 的底层，底层对用户不再透明。 所以 被设计了出来。
sknt参考了云风大神的 skynet 以及 erlang的思想。
尽管如此，一些高性能模块还是由 cobweb 承载的，因为lua本身语言的设计还是会有些先天性缺陷。
特性 支持 cgo 沿用自 cobweb 支持 plugins，为了方便从外部直接加载以满足热更新需求 unix only 支持纯go,当然这是一句废话 支持 lua 原因在于 lua 是一门简单并且性能很高的脚本语言，能显著降低开发成本 mysql支持，dns支持 提供tcp udp,unix支持 不特别区分远程或者本地调用 sknt.send,sknt.call 抹平了本地和集群的区别 参见 sknmpd 实现的http框架，区别于 net/http,仅仅实现部分 RFC 标准,兼容此框架 消息发送默认都是指针，如有需要，可通过一些api来序列化，并使用 sknt.free 方法来释放它。 sknmpd 在sknt中每个节点都是平等的，不存在谁依赖于谁，这也是cobweb的设计初衷。所以sknt 不支持 master/slave 模式，但可以通过业务代码来实现，而非框架本身。
架构 sknt 是函数式以及低抽象的架构
纯函数式主要是受 c language 的影响。也更贴合职责单一的原则"/>

    <meta property="og:title" content="sknt设计初衷以及特性" />
<meta property="og:description" content="简介 sknt 是一个基于消息和服务的分布式服务框架，采用go编写，致力于简化开发难度和成本， 它是一个年轻的框架，仅仅经历了两款项目
羽翼军团 我在民国淘古玩 设计概述 工作中开发一个分布式多人在线游戏的时候构建了一个cobweb的分布式通讯框架（基于golang,c）。
但是在实际开发过程中代码难以维护以及更新，主要是每次都需要跨平台进行编译，特别是cgo 往往需要指定平台的系统库。
而且一些不规范的使用方式造成无法充分发挥多核的优势，可以参见 关于Go协程的思考 虽然1.16 支持抢占式，但错误的使用方式依然造成了cpu过高的问题。
再者，服务器过多的 goroutine 被创建，极大浪费了内存以及cpu。
基于以上目的，重写了cobweb 的底层，底层对用户不再透明。 所以 被设计了出来。
sknt参考了云风大神的 skynet 以及 erlang的思想。
尽管如此，一些高性能模块还是由 cobweb 承载的，因为lua本身语言的设计还是会有些先天性缺陷。
特性 支持 cgo 沿用自 cobweb 支持 plugins，为了方便从外部直接加载以满足热更新需求 unix only 支持纯go,当然这是一句废话 支持 lua 原因在于 lua 是一门简单并且性能很高的脚本语言，能显著降低开发成本 mysql支持，dns支持 提供tcp udp,unix支持 不特别区分远程或者本地调用 sknt.send,sknt.call 抹平了本地和集群的区别 参见 sknmpd 实现的http框架，区别于 net/http,仅仅实现部分 RFC 标准,兼容此框架 消息发送默认都是指针，如有需要，可通过一些api来序列化，并使用 sknt.free 方法来释放它。 sknmpd 在sknt中每个节点都是平等的，不存在谁依赖于谁，这也是cobweb的设计初衷。所以sknt 不支持 master/slave 模式，但可以通过业务代码来实现，而非框架本身。
架构 sknt 是函数式以及低抽象的架构
纯函数式主要是受 c language 的影响。也更贴合职责单一的原则" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://domyson.github.io/post/sknt/sknt/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-06-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-06-20T00:00:00+00:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://domyson.github.io"><img class="app-header-avatar" src="/avatar.jpg" alt="Treasure" /></a>
      <span class="app-header-title">Treasure</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p>无关迟暮,不问翻覆</p>
      <div class="app-header-social">
        
          <a href="https://github.com/domyson" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">sknt设计初衷以及特性</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 20, 2022
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="简介">简介</h1>
<p><code>sknt</code> 是一个基于消息和服务的分布式服务框架，采用<code>go</code>编写，致力于简化开发难度和成本，
它是一个年轻的框架，仅仅经历了两款项目</p>
<ul>
<li><a href="https://www.taptap.cn/app/229839">羽翼军团</a></li>
<li><a href="https://www.taptap.cn/app/215934">我在民国淘古玩</a></li>
</ul>
<h1 id="设计概述">设计概述</h1>
<p>工作中开发一个分布式多人在线游戏的时候构建了一个<code>cobweb</code>的分布式通讯框架（基于<code>golang</code>,<code>c</code>）。</p>
<p>但是在实际开发过程中代码难以维护以及更新，主要是每次都需要跨平台进行编译，特别是<code>cgo</code> 往往需要指定平台的系统库。</p>
<p>而且一些不规范的使用方式造成无法充分发挥多核的优势，可以参见 <code>关于Go协程的思考</code> 虽然1.16 支持抢占式，但错误的使用方式依然造成了cpu过高的问题。</p>
<p>再者，服务器过多的 <code>goroutine</code> 被创建，极大浪费了内存以及cpu。</p>
<p>基于以上目的，重写了<code>cobweb</code> 的底层，底层对用户不再透明。 所以  被设计了出来。</p>
<p><code>sknt</code>参考了云风大神的 <a href="https://github.com/cloudwu/skynet">skynet</a> 以及 <code>erlang</code>的思想。</p>
<p>尽管如此，一些高性能模块还是由 <code>cobweb</code> 承载的，因为lua本身语言的设计还是会有些先天性缺陷。</p>
<h1 id="特性">特性</h1>
<ol>
<li>支持 <code>cgo</code> 沿用自 <code>cobweb</code></li>
<li>支持 <code>plugins</code>，为了方便从外部直接加载以满足热更新需求 <code>unix only</code></li>
<li>支持纯<code>go</code>,当然这是一句废话</li>
<li>支持 <code>lua</code> 原因在于 <code>lua</code> 是一门简单并且性能很高的脚本语言，能显著降低开发成本</li>
<li>mysql支持，dns支持</li>
<li>提供<code>tcp</code> <code>udp</code>,<code>unix</code>支持</li>
<li>不特别区分远程或者本地调用 <code>sknt.send</code>,<code>sknt.call</code> 抹平了本地和集群的区别 参见 <a href="/post/sknt/sknmpd">sknmpd</a></li>
<li>实现的http框架，区别于 <code>net/http</code>,仅仅实现部分 <code>RFC</code> 标准,兼容此框架</li>
<li>消息发送默认都是指针，如有需要，可通过一些api来序列化，并使用 <code>sknt.free</code> 方法来释放它。</li>
</ol>
<h1 id="sknmpdpostskntsknmpd"><a href="/post/sknt/sknmpd">sknmpd</a></h1>
<blockquote>
<p>在<code>sknt</code>中每个节点都是平等的，不存在谁依赖于谁，这也是<code>cobweb</code>的设计初衷。所以<code>sknt</code> 不支持 master/slave 模式，但可以通过业务代码来实现，而非框架本身。</p>
</blockquote>
<h1 id="架构">架构</h1>
<p><code>sknt</code> 是函数式以及低抽象的架构</p>
<p>纯函数式主要是受 <code>c language</code> 的影响。也更贴合职责单一的原则</p>
<p>而低抽象是因为<code>go interface</code> 并非零成本抽象，它由一定的性能代价。所以整个<code>sknt</code> 只有一个接口 <code>Freeable</code>。</p>
<h1 id="运行">运行</h1>
<p><code>sknt</code>执行文件仅仅<code>6.8mb</code>,而运行内存仅仅 <code>2.4mb</code>，65535个Lua服务仅占用<code>1.8GB</code>,也就是每个 <code>Lua服务</code> 仅占用 <code>28.8kb</code>,如果是<code>go</code>服务那么将会更小</p>
<h1 id="example">Example</h1>
<p>懒得写 就写到对应模块中吧</p>
<h1 id="新的计划-20221110">新的计划 2022/11/10</h1>
<p>现在是云服务的时代，今天突发奇想，<code>unknown</code>是否也可以像<code>kubernets</code>一样有编排，治理等功能呢</p>
<p>暂时叫 <code>unknown-nest</code></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
